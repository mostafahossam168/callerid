on:
    pull_request:
        types:
            - closed

name: ðŸš€ Deploy website on PR merge
run-name: Deploy by ${{ github.actor }} on PR #${{ github.event.pull_request.number }}

jobs:
    web-deploy:
        name: ðŸŽ‰ Deploy on Hostinger
        runs-on: ubuntu-latest
        if: github.event.pull_request.merged == true
        steps:
          - name: Connect & deploy via SSH
            uses: fifsky/ssh-action@master
            with:
            host: ${{ vars.HOST }}
            user: ${{ vars.USER_NAME }}
            port: 65002
            key: ${{ secrets.KEY_PRIVATE }}
            pass: ${{ secrets.PASSWORD }}
            args: -tt
            command: |
                cd ~/domains/pxsa.org || exit 1
                if [ -d "callerid/.git" ]; then
                echo "ðŸ”„ Folder exists, pulling latest changes..."
                cd callerid && git pull origin main
                else
                echo "ðŸ“¦ Cloning the repo..."
                git clone https://github.com/mostafahossam168/callerid.git
                cd callerid
                fi
